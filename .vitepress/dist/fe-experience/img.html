<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>next/image가 문제였다고요? | OMG WORLD</title>
    <meta name="description" content="study">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.D2S8aI5d.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.dfFQO34F.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.B9n6DbBv.js">
    <link rel="modulepreload" href="/assets/chunks/framework.DPDPlp3K.js">
    <link rel="modulepreload" href="/assets/fe-experience_img.md.DpOtVUA5.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-09accb63><!--[--><!--]--><!--[--><span tabindex="-1" data-v-def42305></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-def42305>Skip to content</a><!--]--><!----><header class="VPNav" data-v-09accb63 data-v-f7278a59><div class="VPNavBar" data-v-f7278a59 data-v-393c968d><div class="wrapper" data-v-393c968d><div class="container" data-v-393c968d><div class="title" data-v-393c968d><div class="VPNavBarTitle has-sidebar" data-v-393c968d data-v-29ab7144><a class="title" href="/" data-v-29ab7144><!--[--><!--]--><!----><span data-v-29ab7144>OMG WORLD</span><!--[--><!--]--></a></div></div><div class="content" data-v-393c968d><div class="content-body" data-v-393c968d><!--[--><!--]--><div class="VPNavBarSearch search" data-v-393c968d><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-393c968d data-v-dc692c8e><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692c8e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/career.html" tabindex="0" data-v-dc692c8e data-v-76cb4a4f><!--[--><span data-v-76cb4a4f>ABOUT✨ME</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-393c968d data-v-63e91275><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-63e91275 data-v-033681f2 data-v-77bd6c42><span class="check" data-v-77bd6c42><span class="icon" data-v-77bd6c42><!--[--><span class="vpi-sun sun" data-v-033681f2></span><span class="vpi-moon moon" data-v-033681f2></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-393c968d data-v-aeb86684 data-v-c5591831><!--[--><a class="VPSocialLink no-icon" href="https://github.com/min-ji-oh" aria-label="github" target="_blank" rel="noopener" data-v-c5591831 data-v-c9047124><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-393c968d data-v-bd07bf2f data-v-336d6671><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-336d6671><span class="vpi-more-horizontal icon" data-v-336d6671></span></button><div class="menu" data-v-336d6671><div class="VPMenu" data-v-336d6671 data-v-785f6746><!----><!--[--><!--[--><!----><div class="group" data-v-bd07bf2f><div class="item appearance" data-v-bd07bf2f><p class="label" data-v-bd07bf2f>Appearance</p><div class="appearance-action" data-v-bd07bf2f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bd07bf2f data-v-033681f2 data-v-77bd6c42><span class="check" data-v-77bd6c42><span class="icon" data-v-77bd6c42><!--[--><span class="vpi-sun sun" data-v-033681f2></span><span class="vpi-moon moon" data-v-033681f2></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bd07bf2f><div class="item social-links" data-v-bd07bf2f><div class="VPSocialLinks social-links-list" data-v-bd07bf2f data-v-c5591831><!--[--><a class="VPSocialLink no-icon" href="https://github.com/min-ji-oh" aria-label="github" target="_blank" rel="noopener" data-v-c5591831 data-v-c9047124><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-393c968d data-v-59574699><span class="container" data-v-59574699><span class="top" data-v-59574699></span><span class="middle" data-v-59574699></span><span class="bottom" data-v-59574699></span></span></button></div></div></div></div><div class="divider" data-v-393c968d><div class="divider-line" data-v-393c968d></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-09accb63 data-v-df74a8e3><div class="container" data-v-df74a8e3><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-df74a8e3><span class="vpi-align-left menu-icon" data-v-df74a8e3></span><span class="menu-text" data-v-df74a8e3>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-df74a8e3 data-v-8aee46a0><button data-v-8aee46a0>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-09accb63 data-v-34be0a91><div class="curtain" data-v-34be0a91></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-34be0a91><span class="visually-hidden" id="sidebar-aria-label" data-v-34be0a91> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-3b4e7bf7><section class="VPSidebarItem level-0" data-v-3b4e7bf7 data-v-470d45bd><div class="item" role="button" tabindex="0" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><h2 class="text" data-v-470d45bd>코드 잘짜기!</h2><!----></div><div class="items" data-v-470d45bd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-470d45bd data-v-470d45bd><div class="item" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><a class="VPLink link link" href="/clean-code.html" data-v-470d45bd><!--[--><p class="text" data-v-470d45bd>Clean</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-3b4e7bf7><section class="VPSidebarItem level-0" data-v-3b4e7bf7 data-v-470d45bd><div class="item" role="button" tabindex="0" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><h2 class="text" data-v-470d45bd>모던리액트딥다이브</h2><!----></div><div class="items" data-v-470d45bd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-470d45bd data-v-470d45bd><div class="item" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><a class="VPLink link link" href="/modern/state.html" data-v-470d45bd><!--[--><p class="text" data-v-470d45bd>리액트와 상태 관리 라이브러리</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-470d45bd data-v-470d45bd><div class="item" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><a class="VPLink link link" href="/modern/render.html" data-v-470d45bd><!--[--><p class="text" data-v-470d45bd>React 랜더링</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-470d45bd data-v-470d45bd><div class="item" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><a class="VPLink link link" href="/modern/reflow.html" data-v-470d45bd><!--[--><p class="text" data-v-470d45bd>Reflow와 Repaint</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-470d45bd data-v-470d45bd><div class="item" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><a class="VPLink link link" href="/modern/destructure.html" data-v-470d45bd><!--[--><p class="text" data-v-470d45bd>구조 분해 할당</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-470d45bd data-v-470d45bd><div class="item" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><a class="VPLink link link" href="/modern/serverside.html" data-v-470d45bd><!--[--><p class="text" data-v-470d45bd>서버사이드</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-470d45bd data-v-470d45bd><div class="item" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><a class="VPLink link link" href="/modern/web-vitals.html" data-v-470d45bd><!--[--><p class="text" data-v-470d45bd>웹성능지표</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-3b4e7bf7><section class="VPSidebarItem level-0 has-active" data-v-3b4e7bf7 data-v-470d45bd><div class="item" role="button" tabindex="0" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><h2 class="text" data-v-470d45bd>FE 적응기</h2><!----></div><div class="items" data-v-470d45bd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-470d45bd data-v-470d45bd><div class="item" data-v-470d45bd><div class="indicator" data-v-470d45bd></div><a class="VPLink link link" href="/fe-experience/img.html" data-v-470d45bd><!--[--><p class="text" data-v-470d45bd>next/image가 문제였다고요?</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-09accb63 data-v-9a277d40><div class="VPDoc has-sidebar has-aside" data-v-9a277d40 data-v-72aaf74d><!--[--><!--]--><div class="container" data-v-72aaf74d><div class="aside" data-v-72aaf74d><div class="aside-curtain" data-v-72aaf74d></div><div class="aside-container" data-v-72aaf74d><div class="aside-content" data-v-72aaf74d><div class="VPDocAside" data-v-72aaf74d data-v-d140d4c5><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-d140d4c5 data-v-cb4feb8d><div class="content" data-v-cb4feb8d><div class="outline-marker" data-v-cb4feb8d></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-cb4feb8d>On this page</div><ul class="VPDocOutlineItem root" data-v-cb4feb8d data-v-6b452e03><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-d140d4c5></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-72aaf74d><div class="content-container" data-v-72aaf74d><!--[--><!--]--><main class="main" data-v-72aaf74d><div style="position:relative;" class="vp-doc _fe-experience_img" data-v-72aaf74d><div><h1 id="next-image가-문제였다고요" tabindex="-1">next/image가 문제였다고요? <a class="header-anchor" href="#next-image가-문제였다고요" aria-label="Permalink to &quot;next/image가 문제였다고요?&quot;">​</a></h1><p>지난 6개월 동안 열심히 만든 welcome 서비스를 드디어 운영 환경에 정식으로 배포했어요. 그런데 배포 하고 하루 뒤 사용자 수가 예상보다 훨씬 빠르게 증가하면서, 서버에 부하가 걸리기 시작했죠. 처음엔 코드 최적화가 부족했거나 API에 병목이 생긴 줄 알았고 FE들이 해결 할 수 있는 방법이 있을까 멘탈이 흔들리던 차에 이미지 처리가 주요 원인이라는 걸 알아냈어요.</p><h2 id="원인-분석-–-next-js의-이미지-최적화-기능" tabindex="-1">원인 분석 – Next.js의 이미지 최적화 기능 <a class="header-anchor" href="#원인-분석-–-next-js의-이미지-최적화-기능" aria-label="Permalink to &quot;원인 분석 – Next.js의 이미지 최적화 기능&quot;">​</a></h2><p>Next.js는 next/image 컴포넌트를 통해 이미지 관련 작업을 처리하는데요, 기본적으로 자동 이미지 최적화(Image Optimization) 기능이 작동해요. 사용자 입장에서는 UX가 정말 좋아지지만, 문제는 이 이미지 처리를 운영 서버에서 직접 수행한다는 거예요. 이미지 리사이징이나 포맷 변환 같은 작업이 모두 서버 리소스를 사용하니까, CPU 사용률이 급격히 올라갈 수밖에 없어요.</p><p>특히 저희 서비스는 다음과 같은 조건들이 맞물리면서 과부하가 발생했어요:</p><ul><li>이미지가 외부(origin) 도메인에서 로드됨</li><li>이미지 최적화가 서버 사이드에서 수행됨</li><li>트래픽 증가로 동시에 많은 이미지 요청이 발생함</li></ul><p>이런 상황에서는 자연스럽게 서버에 무리가 갈 수밖에 없겠죠.</p><h2 id="해결-–-next-config-js에서-unoptimized-true-설정" tabindex="-1">해결 – next.config.js에서 unoptimized: true 설정 <a class="header-anchor" href="#해결-–-next-config-js에서-unoptimized-true-설정" aria-label="Permalink to &quot;해결 – next.config.js에서 unoptimized: true 설정&quot;">​</a></h2><p>해결 방법은 의외로 간단했어요. 바로 next.config.js 파일에서 아래처럼 설정을 추가한 거예요:</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// next.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  images: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    unoptimized: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>이 설정은 Next.js의 이미지 최적화 기능을 완전히 꺼버리는 거예요. 즉, 이제부터는 서버가 이미지를 리사이징하거나 변환하지 않고, 클라이언트가 원본 이미지를 그대로 받게 되는 거죠.</p><p>그 결과는 정말 극적이었어요. 서버는 더 이상 이미지 처리에 리소스를 쓰지 않게 되었고, CPU 사용률 10%이하로 유지되었어요. 실제로 와탭에서도 극적인 변화가 보였어요. 그리고 다행히 우려했던 것보다 로딩 처리가 느리지 않았답니다..</p><h2 id="고려해야-할-점" tabindex="-1">고려해야 할 점 <a class="header-anchor" href="#고려해야-할-점" aria-label="Permalink to &quot;고려해야 할 점&quot;">​</a></h2><p>물론 unoptimized: true 설정이 완전한 해결책은 아니에요. 이걸 적용하면 Next.js가 제공하는 이미지 최적화 이점(빠른 로딩 속도나 이미지 용량 절감) 들을 포기하는 셈이니까요.</p><p>그래서 함께 고려해볼 수 있는 방안들도 정리해봤어요:</p><ul><li>Vercel을 사용 중이라면 자체 이미지 최적화 서비스를 활용하기</li><li>Cloudinary, imgix 같은 외부 이미지 CDN과 연동해서 처리</li><li>sharp, imagemin 같은 도구를 사용해서 빌드 시점에 미리 최적화 진행하기</li></ul><p>결론적으로는, 서버에서 직접 처리하지 않도록 구성하면서도 최적화는 유지할 수 있는 방법들을 병행하는 게 좋을거같아요.</p><h2 id="마무리하며" tabindex="-1">마무리하며 <a class="header-anchor" href="#마무리하며" aria-label="Permalink to &quot;마무리하며&quot;">​</a></h2><p>이번 경험을 통해 느낀 건, 아무리 좋은 프레임워크를 사용하더라도 운영 환경에서의 리소스 사용을 세밀하게 조정하는 게 정말 중요하다는 점이에요. 특히나 서비스가 성장하거나 트래픽이 빠르게 늘어나는 경우, 성능 병목을 빠르게 파악하고 대응하는 능력이 진짜 중요하다는 걸 다시 한 번 느꼈어요.</p></div></div></main><footer class="VPDocFooter" data-v-72aaf74d data-v-ae05b366><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-ae05b366><span class="visually-hidden" id="doc-footer-aria-label" data-v-ae05b366>Pager</span><div class="pager" data-v-ae05b366><a class="VPLink link pager-link prev" href="/modern/web-vitals.html" data-v-ae05b366><!--[--><span class="desc" data-v-ae05b366>Previous page</span><span class="title" data-v-ae05b366>웹성능지표</span><!--]--></a></div><div class="pager" data-v-ae05b366><!----></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api-examples.md\":\"DSHCdOVk\",\"career_index.md\":\"BQzGFYwZ\",\"clean-code.md\":\"CF5G3JyU\",\"fe-experience_img.md\":\"DpOtVUA5\",\"index.md\":\"AEe3pyj3\",\"markdown-examples.md\":\"h2KhqZVn\",\"modern_destructure.md\":\"Cl5atd5R\",\"modern_index.md\":\"BcyJa99i\",\"modern_reflow.md\":\"4G5yLeg2\",\"modern_render.md\":\"B0NX3WZ_\",\"modern_serverside.md\":\"CX3hpFPg\",\"modern_state.md\":\"B_6Af21A\",\"modern_web-vitals.md\":\"Bfxlk_BN\",\"readme.md\":\"CGYLL9QC\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"OMG WORLD\",\"description\":\"study\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"ABOUT✨ME\",\"link\":\"/career\"}],\"sidebar\":[{\"text\":\"코드 잘짜기!\",\"items\":[{\"text\":\"Clean\",\"link\":\"/clean-code\"}]},{\"text\":\"모던리액트딥다이브\",\"items\":[{\"text\":\"리액트와 상태 관리 라이브러리\",\"link\":\"/modern/state\"},{\"text\":\"React 랜더링\",\"link\":\"/modern/render\"},{\"text\":\"Reflow와 Repaint\",\"link\":\"/modern/reflow\"},{\"text\":\"구조 분해 할당\",\"link\":\"/modern/destructure\"},{\"text\":\"서버사이드\",\"link\":\"/modern/serverside\"},{\"text\":\"웹성능지표\",\"link\":\"/modern/web-vitals\"}]},{\"text\":\"FE 적응기\",\"items\":[{\"text\":\"next/image가 문제였다고요?\",\"link\":\"/fe-experience/img\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/min-ji-oh\"}],\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>